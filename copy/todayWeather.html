<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>날씨 앱</title>
    <link rel="icon" href="./image/bimoicon.png" />
    <style>
      body {
        font-family: Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        background: #e0f7fa;
      }
      .weather-container {
        text-align: center;
        background: #ffffff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
      .weather-icon {
        font-size: 48px;
      }
      .temperature {
        font-size: 32px;
        margin: 10px 0;
      }
      .description {
        font-size: 24px;
        color: #555;
      }
    </style>
  </head>
  <body>
    <div class="weather-container">
      <div id="weather-icon" class="weather-icon">☀️</div>
      <div id="temperature" class="temperature">--°C</div>
      <div id="description" class="description">로딩 중...</div>
    </div>

    <script>
      const API_KEY = "2496a945d5aba6b1ae5b53ddecb57bcd";

      function getWeatherIcon(weatherId) {
        if (weatherId >= 200 && weatherId < 300) return "⛈️"; // 천둥번개
        if (weatherId >= 300 && weatherId < 500) return "🌧️"; // 이슬비
        if (weatherId >= 500 && weatherId < 600) return "🌧️"; // 비
        if (weatherId >= 600 && weatherId < 700) return "❄️"; // 눈
        if (weatherId >= 700 && weatherId < 800) return "🌫️"; // 안개
        if (weatherId === 800) return "☀️"; // 맑음
        if (weatherId > 800) return "☁️"; // 구름
        return "🌡️"; // 기본 날씨 아이콘
      }

      function getWeather(lat, lon) {
        const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric&lang=kr`;

        fetch(url)
          .then((response) => response.json())
          .then((data) => {
            const temperature = data.main.temp;
            const weatherId = data.weather[0].id;
            const description = data.weather[0].description;

            document.getElementById(
              "temperature"
            ).textContent = `${temperature}°C`;
            document.getElementById("weather-icon").textContent =
              getWeatherIcon(weatherId);
            document.getElementById("description").textContent = description;
          })
          .catch((error) => {
            console.error("날씨 데이터를 가져오는 중 오류 발생:", error);
            document.getElementById("description").textContent =
              "날씨 데이터를 불러오지 못했습니다.";
          });
      }

      function getLocation() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            (position) => {
              const lat = position.coords.latitude;
              const lon = position.coords.longitude;
              getWeather(lat, lon);
            },
            (error) => {
              console.error("위치 정보를 가져오는 중 오류 발생:", error);
              document.getElementById("description").textContent =
                "위치 정보를 불러올 수 없습니다.";
            }
          );
        } else {
          document.getElementById("description").textContent =
            "이 브라우저에서는 위치 서비스를 지원하지 않습니다.";
        }
      }

      window.onload = getLocation;
    </script>
  </body>
</html>
